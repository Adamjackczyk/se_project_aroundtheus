!function(){"use strict";var e=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-25",headers:{authorization:"c56e30dc-2883-4270-a59e-b2f7bae969c6","Content-Type":"application/json"}});class t{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)})),this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._toggleLikeButton()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._deleteCard()}))}_toggleLikeButton(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_deleteCard(){this._cardElement.remove(),this._cardElement=null}generateCard(){return this._cardElement=this._getTemplate(),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardElement.querySelector(".card__title").textContent=this._name,this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector),this._inactiveButtonClass=this._settings.inactiveButtonClass}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners(),this.toggleButtonState()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}}class n{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class r extends n{constructor(e,t,s){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".modal__form"),this._formValidator=s}_getInputValues(){return this._formValues={},this._form.querySelectorAll(".modal__input").forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._form.reset(),this._formValidator.toggleButtonState()}))}open(){super.open(),this._formValidator.resetValidation()}}const i={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};function o(e,t){m.open({name:e,link:t})}function a(e){return new t(e,"#card-template",o).generateCard()}const l=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[],renderer:e=>{const t=a(e);l.addItem(t)}},".cards__list"),c={};document.querySelectorAll(i.formSelector).forEach((e=>{const t=new s(i,e);t.enableValidation(),c[e.getAttribute("id")]=t}));const d=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,job:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=s}}({nameSelector:"#profile-title",jobSelector:"#profile-desc"}),h=new r("#profile-edit-modal",(t=>{e.updateProfile({name:t.title,about:t.description}).then((e=>{d.setUserInfo({name:e.name,job:e.about}),h.close()})).catch((e=>{console.error(e)}))}),c["edit-profile-form"]),_=new r("#add-card-modal",(t=>{const s={name:t.title,link:t.link};e.addCard(s).then((e=>{const t=a(e);l.addItem(t),_.close()})).catch((e=>{console.error(e)}))}),c["add-card-form"]);h.setEventListeners(),_.setEventListeners();const m=new class extends n{constructor(e){super(e),this._image=this._popup.querySelector(".modal__image"),this._caption=this._popup.querySelector(".modal__image-label")}open(e){let{name:t,link:s}=e;this._image.src=s,this._image.alt=t,this._caption.textContent=t,super.open()}}("#modal-image-display");m.setEventListeners(),document.getElementById("profile-edit-button").addEventListener("click",(()=>{const e=d.getUserInfo();document.getElementById("profile-title-input").value=e.name,document.getElementById("profile-description-input").value=e.job,h.open()})),document.querySelector(".profile__add-button").addEventListener("click",(()=>{_.open()})),document.addEventListener("DOMContentLoaded",(()=>{e.getUserInfo().then((e=>{d.setUserInfo({name:e.name,job:e.about})})).catch((e=>{console.error(e)})),e.getInitialCards().then((e=>{e.forEach((e=>{const t=a(e);l.addItem(t)}))})).catch((e=>{console.error(e)}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TWMsRUFBY2YsRUFBV0MsR0FDL0JDLEVBQVFVLFFBQVFHLEVBQVksR0FDNUIsSUFFSGdCLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksR0FDbEIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogUmVwcmVzZW50cyBhbiBBUEkgY2xpZW50IGZvciBtYWtpbmcgcmVxdWVzdHMgdG8gYSBzZXJ2ZXIuXHJcbiAqL1xyXG5jbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIHRoZSByZXNwb25zZSBmcm9tIGFuIEFQSSByZXF1ZXN0IGFuZCByZXR1cm5zIHRoZSBKU09OIGRhdGEgaWYgdGhlIHJlc3BvbnNlIGlzIHN1Y2Nlc3NmdWwuXHJcbiAgICogT3RoZXJ3aXNlLCByZWplY3RzIHRoZSBwcm9taXNlIHdpdGggYW4gZXJyb3IgbWVzc2FnZS5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7UmVzcG9uc2V9IHJlcyAtIFRoZSByZXNwb25zZSBvYmplY3QgZnJvbSB0aGUgQVBJIHJlcXVlc3QuXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9IC0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIEpTT04gZGF0YSBvciByZWplY3RzIHdpdGggYW4gZXJyb3IgbWVzc2FnZS5cclxuICAgKi9cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXRyaWV2ZXMgdXNlciBpbmZvcm1hdGlvbiBmcm9tIHRoZSBBUEkuXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIHRoZSB1c2VyIGluZm9ybWF0aW9uLlxyXG4gICAqL1xyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlcyB0aGUgaW5pdGlhbCBzZXQgb2YgY2FyZHMgZnJvbSB0aGUgQVBJLlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgQVBJLlxyXG4gICAqL1xyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGVzIHRoZSB1c2VyIHByb2ZpbGUgd2l0aCB0aGUgcHJvdmlkZWQgZGF0YS5cclxuICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIFRoZSBkYXRhIHRvIHVwZGF0ZSB0aGUgcHJvZmlsZSB3aXRoLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhLm5hbWUgLSBUaGUgbmV3IG5hbWUgZm9yIHRoZSB1c2VyLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhLmFib3V0IC0gVGhlIG5ldyBhYm91dCBzZWN0aW9uIGZvciB0aGUgdXNlci5cclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci5cclxuICAgKi9cclxuICB1cGRhdGVQcm9maWxlKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBjYXJkIHRvIHRoZSBzZXJ2ZXIuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIFRoZSBjYXJkIGRhdGEuXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGEubmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBjYXJkLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhLmxpbmsgLSBUaGUgbGluayBvZiB0aGUgY2FyZC5cclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci5cclxuICAgKi9cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0yNVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYzU2ZTMwZGMtMjg4My00MjcwLWE1OWUtYjJmN2JhZTk2OWM2XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFwaTtcclxuXHJcbi8vIFVzZXIgcm91dGVzXHJcblxyXG4vLyBHRVQgL3VzZXJzL21lIOKAkyBHZXQgdGhlIGN1cnJlbnQgdXNlcuKAmXMgaW5mb1xyXG4vLyBQQVRDSCAvdXNlcnMvbWUg4oCTIFVwZGF0ZSB5b3VyIHByb2ZpbGUgaW5mb3JtYXRpb25cclxuLy8gUEFUQ0ggL3VzZXJzL21lL2F2YXRhciDigJMgVXBkYXRlIGF2YXRhclxyXG4vLyBDYXJkIHJvdXRlc1xyXG5cclxuLy8gR0VUIC9jYXJkcyDigJMgR2V0IGFsbCBjYXJkc1xyXG4vLyBQT1NUIC9jYXJkcyDigJMgQ3JlYXRlIGEgY2FyZFxyXG4vLyBERUxFVEUgL2NhcmRzLzpjYXJkSWQg4oCTIERlbGV0ZSBhIGNhcmRcclxuLy8gUFVUIC9jYXJkcy86Y2FyZElkL2xpa2VzIOKAkyBMaWtlIGEgY2FyZFxyXG4vLyBERUxFVEUgL2NhcmRzLzpjYXJkSWQvbGlrZXMg4oCTIERpc2xpa2UgYSBjYXJkXHJcbiIsIi8vIGNvbXBvbmVudHMvQ2FyZC5qc1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUxpa2VCdXR0b24oKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9kZWxldGVDYXJkKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUxpa2VCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIF9kZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSB8fFxyXG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGZvcm1WYWxpZGF0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2Zvcm1WYWxpZGF0b3IgPSBmb3JtVmFsaWRhdG9yO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKS5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICAgIHRoaXMuX2Zvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2Zvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0aW9uT3B0aW9ucyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsImltcG9ydCBhcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25PcHRpb25zIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VDbGljayk7XHJcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICBpdGVtczogW10sXHJcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuZG9jdW1lbnRcclxuICAucXVlcnlTZWxlY3RvckFsbChmb3JtVmFsaWRhdGlvbk9wdGlvbnMuZm9ybVNlbGVjdG9yKVxyXG4gIC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uT3B0aW9ucywgZm9ybUVsZW1lbnQpO1xyXG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJpZFwiKV0gPSBmb3JtVmFsaWRhdG9yO1xyXG4gIH0pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIjcHJvZmlsZS10aXRsZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIiNwcm9maWxlLWRlc2NcIixcclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLnVwZGF0ZVByb2ZpbGUoe1xyXG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxyXG4gICAgICAgIGFib3V0OiBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbixcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICBqb2I6IGRhdGEuYWJvdXQsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfSxcclxuICBmb3JtVmFsaWRhdG9yc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdXHJcbik7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxyXG4gIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgY29uc3QgbmV3Q2FyZERhdGEgPSB7XHJcbiAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxyXG4gICAgICBsaW5rOiBpbnB1dFZhbHVlcy5saW5rLFxyXG4gICAgfTtcclxuICAgIGFwaVxyXG4gICAgICAuYWRkQ2FyZChuZXdDYXJkRGF0YSlcclxuICAgICAgLnRoZW4oKGNhcmQpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZCk7XHJcbiAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhZGQtY2FyZC1mb3JtXCJdXHJcbik7XHJcblxyXG5wcm9maWxlRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjbW9kYWwtaW1hZ2UtZGlzcGxheVwiKTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1lZGl0LWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtdGl0bGUtaW5wdXRcIikudmFsdWUgPSB1c2VyRGF0YS5uYW1lO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKS52YWx1ZSA9IHVzZXJEYXRhLmpvYjtcclxuICBwcm9maWxlRWRpdFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcclxuICAvLyBGZXRjaCB1c2VyIGluZm9ybWF0aW9uIGFuZCByZW5kZXIgaXRcclxuICBhcGlcclxuICAgIC5nZXRVc2VySW5mbygpXHJcbiAgICAudGhlbigodXNlckluZm9EYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lOiB1c2VySW5mb0RhdGEubmFtZSxcclxuICAgICAgICBqb2I6IHVzZXJJbmZvRGF0YS5hYm91dCxcclxuICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIEZldGNoIGluaXRpYWwgY2FyZHMgYW5kIHJlbmRlciB0aGVtXHJcbiAgYXBpXHJcbiAgICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAgIC50aGVuKChjYXJkcykgPT4ge1xyXG4gICAgICBjYXJkcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1sYWJlbFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJ1cGRhdGVQcm9maWxlIiwiZGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsImFib3V0IiwiYWRkQ2FyZCIsImxpbmsiLCJhdXRob3JpemF0aW9uIiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkSW1hZ2VFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jYXJkRWxlbWVudCIsIl90b2dnbGVMaWtlQnV0dG9uIiwiX2RlbGV0ZUNhcmQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJnZW5lcmF0ZUNhcmQiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJhZGQiLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImZvcm1WYWxpZGF0b3IiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm0iLCJfZm9ybVZhbGlkYXRvciIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJmb3JtVmFsaWRhdGlvbk9wdGlvbnMiLCJmb3JtU2VsZWN0b3IiLCJwb3B1cFdpdGhJbWFnZSIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsInNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImNhcmRFbGVtZW50IiwiZm9ybVZhbGlkYXRvcnMiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJqb2IiLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwicHJvZmlsZUVkaXRQb3B1cCIsImlucHV0VmFsdWVzIiwiYXBpIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYWRkQ2FyZFBvcHVwIiwibmV3Q2FyZERhdGEiLCJjYXJkIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJnZXRFbGVtZW50QnlJZCIsInVzZXJEYXRhIiwidXNlckluZm9EYXRhIiwiY2FyZHMiXSwic291cmNlUm9vdCI6IiJ9