!function(){"use strict";class t{constructor(t,e,s){this._name=t.name,this._link=t.link,this._cardSelector=e,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)})),this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._toggleLikeButton()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._deleteCard()}))}_toggleLikeButton(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_deleteCard(){this._cardElement.remove(),this._cardElement=null}generateCard(){return this._cardElement=this._getTemplate(),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardElement.querySelector(".card__title").textContent=this._name,this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._setEventListeners(),this._cardElement}}class e{constructor(t,e){this._settings=t,this._formElement=e,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector),this._inactiveButtonClass=this._settings.inactiveButtonClass}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_showInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.add(this._settings.inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._settings.errorClass)}_hideInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._settings.inputErrorClass),e.classList.remove(this._settings.errorClass),e.textContent=""}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners(),this.toggleButtonState()}resetValidation(){this._inputList.forEach((t=>{this._hideInputError(t)})),this.toggleButtonState()}}class s{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(t=>{(t.target.classList.contains("modal_opened")||t.target.classList.contains("modal__close"))&&this.close()}))}}class n extends s{constructor(t,e,s){super(t),this._handleFormSubmit=e,this._form=this._popup.querySelector(".modal__form"),this._formValidator=s}_getInputValues(){return this._formValues={},this._form.querySelectorAll(".modal__input").forEach((t=>{this._formValues[t.name]=t.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._form.reset(),this._formValidator.toggleButtonState()}))}open(){super.open(),this._formValidator.resetValidation()}}const i={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};function o(t,e){u.open({name:t,link:e})}function r(e){return new t(e,"#card-template",o).generateCard()}const a=new class{constructor(t,e){let{items:s,renderer:n}=t;this._items=s,this._renderer=n,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>this._renderer(t)))}addItem(t){this._container.prepend(t)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:t=>{const e=r(t);a.addItem(e)}},".cards__list");a.renderItems();const l={};document.querySelectorAll(i.formSelector).forEach((t=>{const s=new e(i,t);s.enableValidation(),l[t.getAttribute("id")]=s}));const c=new class{constructor(t){let{nameSelector:e,jobSelector:s}=t;this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(t){let{name:e,job:s}=t;this._nameElement.textContent=e,this._jobElement.textContent=s}}({nameSelector:"#profile-title",jobSelector:"#profile-desc"}),d=new n("#profile-edit-modal",(t=>{c.setUserInfo({name:t.title,job:t.description}),d.close()}),l["edit-profile-form"]),m=new n("#add-card-modal",(t=>{const e=r({name:t.title,link:t.link});a.addItem(e),m.close()}),l["add-card-form"]);d.setEventListeners(),m.setEventListeners();const u=new class extends s{constructor(t){super(t),this._image=this._popup.querySelector(".modal__image"),this._caption=this._popup.querySelector(".modal__image-label")}open(t){let{name:e,link:s}=t;this._image.src=s,this._image.alt=e,this._caption.textContent=e,super.open()}}("#modal-image-display");u.setEventListeners(),document.getElementById("profile-edit-button").addEventListener("click",(()=>{const t=c.getUserInfo();document.getElementById("profile-title-input").value=t.name,document.getElementById("profile-description-input").value=t.job,d.open()})),document.querySelector(".profile__add-button").addEventListener("click",(()=>{m.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBRWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQVlDLEVBQU1DLEVBQWNDLEdBQzlCQyxLQUFLQyxNQUFRSixFQUFLSyxLQUNsQkYsS0FBS0csTUFBUU4sRUFBS08sS0FDbEJKLEtBQUtLLGNBQWdCUCxFQUNyQkUsS0FBS00sa0JBQW9CUCxDQUMzQixDQUVBUSxZQUFBQSxHQU1FLE9BTG9CQyxTQUNqQkMsY0FBY1QsS0FBS0ssZUFDbkJLLFFBQVFELGNBQWMsU0FDdEJFLFdBQVUsRUFHZixDQUVBQyxrQkFBQUEsR0FDRVosS0FBS2Esa0JBQWtCQyxpQkFBaUIsU0FBUyxLQUMvQ2QsS0FBS00sa0JBQWtCTixLQUFLQyxNQUFPRCxLQUFLRyxNQUFNLElBR2hESCxLQUFLZSxhQUNGTixjQUFjLHNCQUNkSyxpQkFBaUIsU0FBUyxLQUN6QmQsS0FBS2dCLG1CQUFtQixJQUc1QmhCLEtBQUtlLGFBQ0ZOLGNBQWMsd0JBQ2RLLGlCQUFpQixTQUFTLEtBQ3pCZCxLQUFLaUIsYUFBYSxHQUV4QixDQUVBRCxpQkFBQUEsR0FDRWhCLEtBQUtlLGFBQ0ZOLGNBQWMsc0JBQ2RTLFVBQVVDLE9BQU8sMkJBQ3RCLENBRUFGLFdBQUFBLEdBQ0VqQixLQUFLZSxhQUFhSyxTQUNsQnBCLEtBQUtlLGFBQWUsSUFDdEIsQ0FFQU0sWUFBQUEsR0FTRSxPQVJBckIsS0FBS2UsYUFBZWYsS0FBS08sZUFDekJQLEtBQUthLGtCQUFvQmIsS0FBS2UsYUFBYU4sY0FBYyxnQkFDekRULEtBQUtlLGFBQWFOLGNBQWMsZ0JBQWdCYSxZQUFjdEIsS0FBS0MsTUFDbkVELEtBQUthLGtCQUFrQlUsSUFBTXZCLEtBQUtHLE1BQ2xDSCxLQUFLYSxrQkFBa0JXLElBQU14QixLQUFLQyxNQUVsQ0QsS0FBS1kscUJBRUVaLEtBQUtlLFlBQ2QsRUMxRGEsTUFBTVUsRUFDbkI3QixXQUFBQSxDQUFZOEIsRUFBVUMsR0FDcEIzQixLQUFLNEIsVUFBWUYsRUFDakIxQixLQUFLNkIsYUFBZUYsRUFDcEIzQixLQUFLOEIsV0FBYUMsTUFBTUMsS0FDdEJoQyxLQUFLNkIsYUFBYUksaUJBQWlCakMsS0FBSzRCLFVBQVVNLGdCQUVwRGxDLEtBQUttQyxjQUFnQm5DLEtBQUs2QixhQUFhcEIsY0FDckNULEtBQUs0QixVQUFVUSxzQkFFakJwQyxLQUFLcUMscUJBQXVCckMsS0FBSzRCLFVBQVVVLG1CQUM3QyxDQUVBQyxnQkFBQUEsR0FDRSxPQUFPdkMsS0FBSzhCLFdBQVdVLE1BQU1DLElBQWtCQSxFQUFhQyxTQUFTQyxPQUN2RSxDQUVBQyxpQkFBQUEsR0FDTTVDLEtBQUt1QyxvQkFDUHZDLEtBQUttQyxjQUFjakIsVUFBVTJCLElBQUk3QyxLQUFLcUMsc0JBQ3RDckMsS0FBS21DLGNBQWNXLFVBQVcsSUFFOUI5QyxLQUFLbUMsY0FBY2pCLFVBQVVFLE9BQU9wQixLQUFLcUMsc0JBQ3pDckMsS0FBS21DLGNBQWNXLFVBQVcsRUFFbEMsQ0FFQUMsbUJBQUFBLENBQW9CTixHQUNiQSxFQUFhQyxTQUFTQyxNQUd6QjNDLEtBQUtnRCxnQkFBZ0JQLEdBRnJCekMsS0FBS2lELGdCQUFnQlIsRUFJekIsQ0FFQVEsZUFBQUEsQ0FBZ0JSLEdBQ2QsTUFBTVMsRUFBZWxELEtBQUs2QixhQUFhcEIsY0FDckMsSUFBSWdDLEVBQWFVLFlBRW5CVixFQUFhdkIsVUFBVTJCLElBQUk3QyxLQUFLNEIsVUFBVXdCLGlCQUMxQ0YsRUFBYTVCLFlBQWNtQixFQUFhWSxrQkFDeENILEVBQWFoQyxVQUFVMkIsSUFBSTdDLEtBQUs0QixVQUFVMEIsV0FDNUMsQ0FFQU4sZUFBQUEsQ0FBZ0JQLEdBQ2QsTUFBTVMsRUFBZWxELEtBQUs2QixhQUFhcEIsY0FDckMsSUFBSWdDLEVBQWFVLFlBRW5CVixFQUFhdkIsVUFBVUUsT0FBT3BCLEtBQUs0QixVQUFVd0IsaUJBQzdDRixFQUFhaEMsVUFBVUUsT0FBT3BCLEtBQUs0QixVQUFVMEIsWUFDN0NKLEVBQWE1QixZQUFjLEVBQzdCLENBRUFWLGtCQUFBQSxHQUNFWixLQUFLOEIsV0FBV3lCLFNBQVNkLElBQ3ZCQSxFQUFhM0IsaUJBQWlCLFNBQVMsS0FDckNkLEtBQUsrQyxvQkFBb0JOLEdBQ3pCekMsS0FBSzRDLG1CQUFtQixHQUN4QixHQUVOLENBRUFZLGdCQUFBQSxHQUNFeEQsS0FBS1kscUJBQ0xaLEtBQUs0QyxtQkFDUCxDQUVBYSxlQUFBQSxHQUNFekQsS0FBSzhCLFdBQVd5QixTQUFTZCxJQUN2QnpDLEtBQUtnRCxnQkFBZ0JQLEVBQWEsSUFFcEN6QyxLQUFLNEMsbUJBQ1AsRUN4RWEsTUFBTWMsRUFDbkI5RCxXQUFBQSxDQUFZK0QsR0FDVjNELEtBQUs0RCxPQUFTcEQsU0FBU0MsY0FBY2tELEdBQ3JDM0QsS0FBSzZELGdCQUFrQjdELEtBQUs2RCxnQkFBZ0JDLEtBQUs5RCxLQUNuRCxDQUVBK0QsSUFBQUEsR0FDRS9ELEtBQUs0RCxPQUFPMUMsVUFBVTJCLElBQUksZ0JBQzFCckMsU0FBU00saUJBQWlCLFVBQVdkLEtBQUs2RCxnQkFDNUMsQ0FFQUcsS0FBQUEsR0FDRWhFLEtBQUs0RCxPQUFPMUMsVUFBVUUsT0FBTyxnQkFDN0JaLFNBQVN5RCxvQkFBb0IsVUFBV2pFLEtBQUs2RCxnQkFDL0MsQ0FFQUEsZUFBQUEsQ0FBZ0JLLEdBQ0ksV0FBZEEsRUFBTUMsS0FDUm5FLEtBQUtnRSxPQUVULENBRUFJLGlCQUFBQSxHQUNFcEUsS0FBSzRELE9BQU85QyxpQkFBaUIsYUFBY29ELEtBRXZDQSxFQUFNRyxPQUFPbkQsVUFBVW9ELFNBQVMsaUJBQ2hDSixFQUFNRyxPQUFPbkQsVUFBVW9ELFNBQVMsa0JBRWhDdEUsS0FBS2dFLE9BQ1AsR0FFSixFQzdCYSxNQUFNTyxVQUFzQmIsRUFDekM5RCxXQUFBQSxDQUFZK0QsRUFBZWEsRUFBa0JDLEdBQzNDQyxNQUFNZixHQUNOM0QsS0FBSzJFLGtCQUFvQkgsRUFDekJ4RSxLQUFLNEUsTUFBUTVFLEtBQUs0RCxPQUFPbkQsY0FBYyxnQkFDdkNULEtBQUs2RSxlQUFpQkosQ0FDeEIsQ0FFQUssZUFBQUEsR0FLRSxPQUpBOUUsS0FBSytFLFlBQWMsQ0FBQyxFQUNwQi9FLEtBQUs0RSxNQUFNM0MsaUJBQWlCLGlCQUFpQnNCLFNBQVN5QixJQUNwRGhGLEtBQUsrRSxZQUFZQyxFQUFNOUUsTUFBUThFLEVBQU1DLEtBQUssSUFFckNqRixLQUFLK0UsV0FDZCxDQUVBWCxpQkFBQUEsR0FDRU0sTUFBTU4sb0JBQ05wRSxLQUFLNEUsTUFBTTlELGlCQUFpQixVQUFXb0QsSUFDckNBLEVBQU1nQixpQkFDTmxGLEtBQUsyRSxrQkFBa0IzRSxLQUFLOEUsbUJBQzVCOUUsS0FBSzRFLE1BQU1PLFFBQ1huRixLQUFLNkUsZUFBZWpDLG1CQUFtQixHQUUzQyxDQUVBbUIsSUFBQUEsR0FDRVcsTUFBTVgsT0FDTi9ELEtBQUs2RSxlQUFlcEIsaUJBQ3RCLEVDL0JLLE1BMkJNMkIsRUFBd0IsQ0FDbkNDLGFBQWMsZUFDZG5ELGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJFLG9CQUFxQix5QkFDckJjLGdCQUFpQiwwQkFDakJFLFdBQVksd0JDeEJkLFNBQVN2RCxFQUFpQkcsRUFBTUUsR0FDOUJrRixFQUFldkIsS0FBSyxDQUFFN0QsT0FBTUUsUUFDOUIsQ0FFQSxTQUFTbUYsRUFBV0MsR0FFbEIsT0FEYSxJQUFJN0YsRUFBSzZGLEVBQVUsaUJBQWtCekYsR0FDdENzQixjQUNkLENBRUEsTUFBTW9FLEVBQVUsSUNsQkQsTUFDYjdGLFdBQUFBLENBQVc4RixFQUFzQkMsR0FBbUIsSUFBeEMsTUFBRUMsRUFBSyxTQUFFQyxHQUFVSCxFQUM3QjFGLEtBQUs4RixPQUFTRixFQUNkNUYsS0FBSytGLFVBQVlGLEVBQ2pCN0YsS0FBS2dHLFdBQWF4RixTQUFTQyxjQUFja0YsRUFDM0MsQ0FFQU0sV0FBQUEsR0FDRWpHLEtBQUs4RixPQUFPdkMsU0FBUzJDLEdBQVNsRyxLQUFLK0YsVUFBVUcsSUFDL0MsQ0FFQUMsT0FBQUEsQ0FBUUMsR0FDTnBHLEtBQUtnRyxXQUFXSyxRQUFRRCxFQUMxQixHRE1BLENBQ0VSLE1EcEJ3QixDQUMxQixDQUNFMUYsS0FBTSxrQkFDTkUsS0FBTSxzR0FFUixDQUNFRixLQUFNLGNBQ05FLEtBQU0seUdBRVIsQ0FDRUYsS0FBTSxpQkFDTkUsS0FBTSw0R0FFUixDQUNFRixLQUFNLFVBQ05FLEtBQU0scUdBRVIsQ0FDRUYsS0FBTSx3QkFDTkUsS0FBTSxxR0FFUixDQUNFRixLQUFNLGlCQUNORSxLQUFNLG1HQ0ZOeUYsU0FBV0wsSUFDVCxNQUFNYyxFQUFjZixFQUFXQyxHQUMvQkMsRUFBUVUsUUFBUUcsRUFBWSxHQUdoQyxnQkFHRmIsRUFBUVEsY0FFUixNQUFNTSxFQUFpQixDQUFDLEVBQ3hCL0YsU0FDR3lCLGlCQUFpQm1ELEVBQXNCQyxjQUN2QzlCLFNBQVM1QixJQUNSLE1BQU04QyxFQUFnQixJQUFJaEQsRUFBYzJELEVBQXVCekQsR0FDL0Q4QyxFQUFjakIsbUJBQ2QrQyxFQUFlNUUsRUFBWTZFLGFBQWEsT0FBUy9CLENBQWEsSUFHbEUsTUFBTWdDLEVBQVcsSUV4Q0YsTUFDYjdHLFdBQUFBLENBQVc4RixHQUFnQyxJQUEvQixhQUFFZ0IsRUFBWSxZQUFFQyxHQUFhakIsRUFDdkMxRixLQUFLNEcsYUFBZXBHLFNBQVNDLGNBQWNpRyxHQUMzQzFHLEtBQUs2RyxZQUFjckcsU0FBU0MsY0FBY2tHLEVBQzVDLENBRUFHLFdBQUFBLEdBQ0UsTUFBTyxDQUNMNUcsS0FBTUYsS0FBSzRHLGFBQWF0RixZQUN4QnlGLElBQUsvRyxLQUFLNkcsWUFBWXZGLFlBRTFCLENBRUEwRixXQUFBQSxDQUFXQyxHQUFnQixJQUFmLEtBQUUvRyxFQUFJLElBQUU2RyxHQUFLRSxFQUN2QmpILEtBQUs0RyxhQUFhdEYsWUFBY3BCLEVBQ2hDRixLQUFLNkcsWUFBWXZGLFlBQWN5RixDQUNqQyxHRndCNEIsQ0FDNUJMLGFBQWMsaUJBQ2RDLFlBQWEsa0JBR1RPLEVBQW1CLElBQUkzQyxFQUMzQix1QkFDQzRDLElBQ0NWLEVBQVNPLFlBQVksQ0FDbkI5RyxLQUFNaUgsRUFBWUMsTUFDbEJMLElBQUtJLEVBQVlFLGNBRW5CSCxFQUFpQmxELE9BQU8sR0FFMUJ1QyxFQUFlLHNCQUdYZSxFQUFlLElBQUkvQyxFQUN2QixtQkFDQzRDLElBQ0MsTUFJTWIsRUFBY2YsRUFKQSxDQUNsQnJGLEtBQU1pSCxFQUFZQyxNQUNsQmhILEtBQU0rRyxFQUFZL0csT0FHcEJxRixFQUFRVSxRQUFRRyxHQUNoQmdCLEVBQWF0RCxPQUFPLEdBRXRCdUMsRUFBZSxrQkFHakJXLEVBQWlCOUMsb0JBQ2pCa0QsRUFBYWxELG9CQUViLE1BQU1rQixFQUFpQixJR3hFUixjQUE2QjVCLEVBQzFDOUQsV0FBQUEsQ0FBWStELEdBQ1ZlLE1BQU1mLEdBQ04zRCxLQUFLdUgsT0FBU3ZILEtBQUs0RCxPQUFPbkQsY0FBYyxpQkFDeENULEtBQUt3SCxTQUFXeEgsS0FBSzRELE9BQU9uRCxjQUFjLHNCQUM1QyxDQUVBc0QsSUFBQUEsQ0FBSTJCLEdBQWlCLElBQWhCLEtBQUV4RixFQUFJLEtBQUVFLEdBQU1zRixFQUNqQjFGLEtBQUt1SCxPQUFPaEcsSUFBTW5CLEVBQ2xCSixLQUFLdUgsT0FBTy9GLElBQU10QixFQUNsQkYsS0FBS3dILFNBQVNsRyxZQUFjcEIsRUFDNUJ3RSxNQUFNWCxNQUNSLEdINER3Qyx3QkFDMUN1QixFQUFlbEIsb0JBRWY1RCxTQUFTaUgsZUFBZSx1QkFBdUIzRyxpQkFBaUIsU0FBUyxLQUN2RSxNQUFNNEcsRUFBV2pCLEVBQVNLLGNBQzFCdEcsU0FBU2lILGVBQWUsdUJBQXVCeEMsTUFBUXlDLEVBQVN4SCxLQUNoRU0sU0FBU2lILGVBQWUsNkJBQTZCeEMsTUFBUXlDLEVBQVNYLElBQ3RFRyxFQUFpQm5ELE1BQU0sSUFHekJ2RCxTQUFTQyxjQUFjLHdCQUF3QkssaUJBQWlCLFNBQVMsS0FDdkV3RyxFQUFhdkQsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjb21wb25lbnRzL0NhcmQuanNcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVMaWtlQnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQ2FyZCgpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVMaWtlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSB0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0LCBmb3JtVmFsaWRhdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9mb3JtVmFsaWRhdG9yID0gZm9ybVZhbGlkYXRvcjtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIikuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgICB0aGlzLl9mb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9mb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbk9wdGlvbnMgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBmb3JtVmFsaWRhdGlvbk9wdGlvbnMgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcclxuICBwb3B1cFdpdGhJbWFnZS5vcGVuKHsgbmFtZSwgbGluayB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBoYW5kbGVJbWFnZUNsaWNrKTtcclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuZG9jdW1lbnRcclxuICAucXVlcnlTZWxlY3RvckFsbChmb3JtVmFsaWRhdGlvbk9wdGlvbnMuZm9ybVNlbGVjdG9yKVxyXG4gIC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uT3B0aW9ucywgZm9ybUVsZW1lbnQpO1xyXG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJpZFwiKV0gPSBmb3JtVmFsaWRhdG9yO1xyXG4gIH0pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIjcHJvZmlsZS10aXRsZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIiNwcm9maWxlLWRlc2NcIixcclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxyXG4gICAgICBqb2I6IGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uLFxyXG4gICAgfSk7XHJcbiAgICBwcm9maWxlRWRpdFBvcHVwLmNsb3NlKCk7XHJcbiAgfSxcclxuICBmb3JtVmFsaWRhdG9yc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdXHJcbik7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxyXG4gIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgY29uc3QgbmV3Q2FyZERhdGEgPSB7XHJcbiAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxyXG4gICAgICBsaW5rOiBpbnB1dFZhbHVlcy5saW5rLFxyXG4gICAgfTtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChuZXdDYXJkRGF0YSk7XHJcbiAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgfSxcclxuICBmb3JtVmFsaWRhdG9yc1tcImFkZC1jYXJkLWZvcm1cIl1cclxuKTtcclxuXHJcbnByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNtb2RhbC1pbWFnZS1kaXNwbGF5XCIpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWVkaXQtYnV0dG9uXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS10aXRsZS1pbnB1dFwiKS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCIpLnZhbHVlID0gdXNlckRhdGEuam9iO1xyXG4gIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1sYWJlbFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRFbGVtZW50IiwiX3RvZ2dsZUxpa2VCdXR0b24iLCJfZGVsZXRlQ2FyZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImdlbmVyYXRlQ2FyZCIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsImlucHV0RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImFkZCIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yRWxlbWVudCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvckNsYXNzIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiZm9ybVZhbGlkYXRvciIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9mb3JtVmFsaWRhdG9yIiwiX2dldElucHV0VmFsdWVzIiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsImZvcm1WYWxpZGF0aW9uT3B0aW9ucyIsImZvcm1TZWxlY3RvciIsInBvcHVwV2l0aEltYWdlIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwic2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZEVsZW1lbnQiLCJmb3JtVmFsaWRhdG9ycyIsImdldEF0dHJpYnV0ZSIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwic2V0VXNlckluZm8iLCJfcmVmMiIsInByb2ZpbGVFZGl0UG9wdXAiLCJpbnB1dFZhbHVlcyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJhZGRDYXJkUG9wdXAiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsImdldEVsZW1lbnRCeUlkIiwidXNlckRhdGEiXSwic291cmNlUm9vdCI6IiJ9